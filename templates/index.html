<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firefighter Situation Map</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: system-ui, -apple-system, sans-serif;
    }
    
    .map-container {
      position: relative;
      width: 100%;
      height: 100%;
      background: #1a1a1a;
    }
    
    .map-layer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    
    .map-layer.active {
      pointer-events: auto;
    }
    
    .firefighter-marker {
      position: absolute;
      width: 32px;
      height: 32px;
      border: 3px solid #fff;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      transition: all 0.3s;
    }
    
    .firefighter-marker:hover {
      transform: translate(-50%, -50%) scale(1.2);
    }
    
    .o2-bar {
      height: 8px;
      border-radius: 4px;
      transition: width 0.3s, background 0.3s;
    }
    
    .o2-bar.high {
      background: #22c55e;
    }
    
    .o2-bar.medium {
      background: #eab308;
    }
    
    .o2-bar.low {
      background: #ef4444;
    }
    
    .o2-bar.critical {
      background: #dc2626;
      animation: pulse 1s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .heat-gradient {
      background: radial-gradient(circle at 30% 40%, rgba(255, 0, 0, 0.6) 0%, transparent 40%),
                  radial-gradient(circle at 70% 60%, rgba(255, 100, 0, 0.5) 0%, transparent 35%),
                  radial-gradient(circle at 50% 80%, rgba(255, 150, 0, 0.4) 0%, transparent 30%);
    }
    
    #annotationCanvas {
      cursor: crosshair;
    }
    
    .toggle-btn {
      transition: all 0.2s;
    }
    
    .toggle-btn.active {
      background: #3b82f6;
      color: white;
    }
  </style>
</head>
<body class="bg-gray-900 text-white">
  <div class="flex h-screen">
    <div class="w-80 bg-gray-800 border-r border-gray-700 overflow-y-auto">
      <div class="p-4 bg-red-600 border-b border-red-700">
        <h1 class="text-xl font-bold">Firefighter Status</h1>
        <p class="text-sm text-red-100">Live Monitoring</p>
      </div>
      
      <div id="firefighterList" class="divide-y divide-gray-700">
         Firefighter cards will be inserted here 
      </div>
    </div>
    <div class="flex-1 flex flex-col">
      <div class="bg-gray-800 border-b border-gray-700 p-4">
        <div class="flex items-center justify-between">
          <div class="flex gap-2">
            <button id="toggleLocations" class="toggle-btn px-4 py-2 bg-gray-700 rounded hover:bg-gray-600 active">
              üìç Locations
            </button>
            <button id="toggleHeatMap" class="toggle-btn px-4 py-2 bg-gray-700 rounded hover:bg-gray-600">
              üî• Heat Map
            </button>
            <button id="toggleAnnotations" class="toggle-btn px-4 py-2 bg-gray-700 rounded hover:bg-gray-600">
              ‚úèÔ∏è Annotations
            </button>
          </div>
          
          <div class="flex gap-2">
            <button id="clearAnnotations" class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600">
              üóëÔ∏è Clear Drawings
            </button>
            <select id="drawColor" class="px-3 py-2 bg-gray-700 rounded">
              <option value="#ef4444">Red</option>
              <option value="#3b82f6">Blue</option>
              <option value="#22c55e">Green</option>
              <option value="#eab308">Yellow</option>
              <option value="#ffffff">White</option>
            </select>
          </div>
        </div>
      </div>
      <div class="flex-1 relative">
        <div class="map-container">
           Base Map Layer 
          <div class="map-layer" style="background: #2d3748;">
            <svg width="100%" height="100%" style="position: absolute;">
               Exterior walls 
              <rect x="10%" y="10%" width="80%" height="80%" fill="#1a202c" stroke="#4a5568" stroke-width="4"/>
              
               Living Room (top left) 
              <rect x="10%" y="10%" width="35%" height="35%" fill="none" stroke="#4a5568" stroke-width="2"/>
              <text x="20%" y="28%" fill="#9ca3af" font-size="16" font-weight="bold">Living Room</text>
              
               Kitchen (top right) 
              <rect x="45%" y="10%" width="45%" height="35%" fill="none" stroke="#4a5568" stroke-width="2"/>
              <text x="60%" y="28%" fill="#9ca3af" font-size="16" font-weight="bold">Kitchen</text>
              
               Hallway (middle horizontal) 
              <line x1="10%" y1="45%" x2="90%" y2="45%" stroke="#4a5568" stroke-width="2"/>
              <line x1="10%" y1="55%" x2="90%" y2="55%" stroke="#4a5568" stroke-width="2"/>
              <text x="43%" y="52%" fill="#9ca3af" font-size="14">Hall</text>
              
               Bedroom 1 (bottom left) 
              <rect x="10%" y="55%" width="35%" height="35%" fill="none" stroke="#4a5568" stroke-width="2"/>
              <text x="18%" y="73%" fill="#9ca3af" font-size="16" font-weight="bold">Bedroom 1</text>
              
               Bedroom 2 (bottom middle) 
              <rect x="45%" y="55%" width="25%" height="35%" fill="none" stroke="#4a5568" stroke-width="2"/>
              <text x="48%" y="73%" fill="#9ca3af" font-size="16" font-weight="bold">Bedroom 2</text>
              
               Bathroom (bottom right) 
              <rect x="70%" y="55%" width="20%" height="35%" fill="none" stroke="#4a5568" stroke-width="2"/>
              <text x="72%" y="73%" fill="#9ca3af" font-size="14" font-weight="bold">Bath</text>
              
               Doors (purple) 
              <rect x="43%" y="44%" width="4%" height="2%" fill="#a855f7"/>
              <rect x="27%" y="53%" width="2%" height="4%" fill="#a855f7"/>
              <rect x="55%" y="53%" width="2%" height="4%" fill="#a855f7"/>
              <rect x="68%" y="53%" width="2%" height="4%" fill="#a855f7"/>
              
               Windows (blue) 
              <rect x="15%" y="10%" width="8%" height="1%" fill="#3b82f6"/>
              <rect x="35%" y="10%" width="8%" height="1%" fill="#3b82f6"/>
              <rect x="60%" y="10%" width="8%" height="1%" fill="#3b82f6"/>
              <rect x="10%" y="65%" width="1%" height="8%" fill="#3b82f6"/>
              <rect x="10%" y="78%" width="1%" height="8%" fill="#3b82f6"/>
            </svg>
          </div>
          
           Heat Map Layer 
          <div id="heatMapLayer" class="map-layer heat-gradient" style="display: none;"></div>
          
           Firefighter Locations Layer 
          <div id="locationsLayer" class="map-layer">
             Firefighter markers will be inserted here 
          </div>
          
           Annotation Layer 
          <canvas id="annotationCanvas" class="map-layer" style="display: none;"></canvas>
        </div>
      </div>
       
      <div class="bg-gray-800 border-t border-gray-700 p-3">
        <div class="flex items-center justify-between text-sm">
          <div class="flex gap-6">
            <span>üö® Active Incident: Structure Fire</span>
            <span>üë• Personnel: <span id="personnelCount">3</span> Active</span>
            <span>‚è±Ô∏è Duration: <span id="incidentTime">00:00:00</span></span>
          </div>
          <div class="text-yellow-400 font-semibold">
            ‚ö†Ô∏è High Temperature Zone Detected
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Firefighter data
    const firefighters = [
      { id: 1, name: 'Cpt. DARREN', o2: 85, x: 27, y: 27, status: 'active' },
      { id: 2, name: 'Pvt. JUDITH', o2: 45, x: 67, y: 27, status: 'warning' },
      { id: 3, name: 'Pvt. BERNICE', o2: 28, x: 27, y: 73, status: 'critical' }
    ];
    
    function getO2Color(o2Level) {
      if (o2Level < 30) return '#dc2626'; // Critical - red
      if (o2Level < 50) return '#ef4444'; // Low - orange-red
      if (o2Level < 75) return '#eab308'; // Medium - yellow
      return '#22c55e'; // High - green
    }
    
    // Initialize firefighter list
    function initFirefighterList() {
      const list = document.getElementById('firefighterList');
      list.innerHTML = ''; // Clear existing list
      firefighters.forEach(ff => {
        const card = document.createElement('div');
        card.className = 'p-4 hover:bg-gray-750';
        
        let o2Class = 'high';
        if (ff.o2 < 30) o2Class = 'critical';
        else if (ff.o2 < 50) o2Class = 'low';
        else if (ff.o2 < 75) o2Class = 'medium';
        
        card.innerHTML = `
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-red-500 to-orange-600 flex items-center justify-center text-xl font-bold">
              ${ff.id}
            </div>
            <div class="flex-1">
              <div class="font-semibold">${ff.name}</div>
              <div class="text-sm text-gray-400 mt-1">O‚ÇÇ Level: ${ff.o2}%</div>
              <div class="w-full bg-gray-700 rounded-full h-2 mt-2">
                <div class="o2-bar ${o2Class}" style="width: ${ff.o2}%"></div>
              </div>
            </div>
          </div>
        `;
        list.appendChild(card);
      });
    }
    
    // Initialize firefighter markers on map
    function initFirefighterMarkers() {
      const layer = document.getElementById('locationsLayer');
      layer.innerHTML = ''; // Clear existing markers
      firefighters.forEach(ff => {
        const marker = document.createElement('div');
        marker.className = 'firefighter-marker';
        marker.style.left = `${ff.x}%`;
        marker.style.top = `${ff.y}%`;
        marker.style.background = getO2Color(ff.o2);
        marker.textContent = ff.id;
        marker.title = `${ff.name} - O‚ÇÇ: ${ff.o2}%`;
        layer.appendChild(marker);
      });
    }
    
    // Toggle controls
    const toggleHeatMap = document.getElementById('toggleHeatMap');
    const toggleLocations = document.getElementById('toggleLocations');
    const toggleAnnotations = document.getElementById('toggleAnnotations');
    const heatMapLayer = document.getElementById('heatMapLayer');
    const locationsLayer = document.getElementById('locationsLayer');
    const annotationCanvas = document.getElementById('annotationCanvas');
    
    toggleHeatMap.addEventListener('click', () => {
      toggleHeatMap.classList.toggle('active');
      heatMapLayer.style.display = toggleHeatMap.classList.contains('active') ? 'block' : 'none';
    });
    
    toggleLocations.addEventListener('click', () => {
      toggleLocations.classList.toggle('active');
      locationsLayer.style.display = toggleLocations.classList.contains('active') ? 'block' : 'none';
    });
    
    toggleAnnotations.addEventListener('click', () => {
      const isOn = toggleAnnotations.classList.toggle('active');
      annotationCanvas.style.display = isOn ? 'block' : 'none';
      annotationCanvas.classList.toggle('active', isOn);
      if (isOn) resizeCanvas(); 
    });
    
    // Annotation canvas setup
    const canvas = annotationCanvas;
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let lastX = 0;
    let lastY = 0;
    
    function resizeCanvas() {
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;
    }
    
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    
    canvas.addEventListener('mousedown', (e) => {
      if (!toggleAnnotations.classList.contains('active')) return;
      isDrawing = true;
      [lastX, lastY] = [e.offsetX, e.offsetY];
    });
    
    canvas.addEventListener('mousemove', (e) => {
      if (!isDrawing) return;
      ctx.strokeStyle = document.getElementById('drawColor').value;
      ctx.lineWidth = 3;
      ctx.lineCap = 'round';
      ctx.beginPath();
      ctx.moveTo(lastX, lastY);
      ctx.lineTo(e.offsetX, e.offsetY);
      ctx.stroke();
      [lastX, lastY] = [e.offsetX, e.offsetY];
    });
    
    canvas.addEventListener('mouseup', () => isDrawing = false);
    canvas.addEventListener('mouseout', () => isDrawing = false);
    
    document.getElementById('clearAnnotations').addEventListener('click', () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    });
    
    // Update incident timer
    let seconds = 0;
    setInterval(() => {
      seconds++;
      const hrs = Math.floor(seconds / 3600);
      const mins = Math.floor((seconds % 3600) / 60);
      const secs = seconds % 60;
      document.getElementById('incidentTime').textContent = 
        `${String(hrs).padStart(2, '0')}:${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
    }, 1000);
    
    // Initialize
    initFirefighterList();
    initFirefighterMarkers();
    document.getElementById('personnelCount').textContent = firefighters.length;
  </script>
</body>
</html>
